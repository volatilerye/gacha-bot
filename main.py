import os

import discord
from dotenv import load_dotenv

from gacha import gacha

load_dotenv()

TOKEN = os.getenv("DISCORD_BOT_TOKEN")

intents = discord.Intents.default()
intents.message_content = True

client = discord.Client(intents=intents)


@client.event
async def on_ready():
    print(f"logged in as {client.user}")


@client.event
async def on_message(message):
    # do not respond to bot messages
    if message.author.bot:
        return

    if message.content.startswith("!gacha"):
        try:
            response = gacha(message.content.split("\n", maxsplit=1)[1])
        except Exception as e:
            response = (
            "âŒ å¤±æ•—: å…¥åŠ›æ–¹æ³•ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“ï¼\n"
            '"?gacha" ã‚³ãƒãƒ³ãƒ‰ã§ä½¿ã„æ–¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„'
        )

        await message.channel.send(response)
    elif message.content == "?gacha":
        response = (
            "## ğŸ’¸ ã‚¬ãƒãƒ£ã‚¬ãƒãƒ£ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿\n"
            "å¼•ããŸã„ã‚¬ãƒãƒ£ã‚’æƒãˆã‚‹ã®ã«å¿…è¦ãªå›æ•°ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã—ã‚ˆã†ï¼\n\n"
            "```\n"
            "!gacha\n"
            "[ã‚¢ã‚¤ãƒ†ãƒ å], [å‡ºç¾ç¢ºç‡ (ã¾ãŸã¯ç¢ºç‡ã®æ•´æ•°æ¯”)], [å¿…è¦æ•° (ã‚ªãƒ—ã‚·ãƒ§ãƒ³, ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯1)]\n"
            "...\n"
            "```\n"
            "### âœï¸ ä¾‹: å‡ºç¾ç¢ºç‡0.01(=1%) ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’1å€‹ã‚²ãƒƒãƒˆã™ã‚‹ã®ã«ä½•å›ã‚¬ãƒãƒ£ãŒå¿…è¦ï¼Ÿ\n"
            "```\n"
            "!gacha\n"
            "ã‚¢ã‚¤ãƒ†ãƒ A, 0.01\n"
            "```\n"
            "```\n"
            "1%: 1å›\n"
            "5%: 6å›\n"
            "10%: 11å›\n"
            "20%: 23å›\n"
            "25%: 29å›\n"
            "50%: 69å›\n"
            "75%: 138å›\n"
            "80%: 161å›\n"
            "90%: 230å›\n"
            "95%: 299å›\n"
            "99%: 459å›\n"
            "å¹³å‡: 100.00å›\n"
            "æ¨™æº–åå·®: 99.50å›\n"
            "æœ€é »å€¤: 1å›\n"
            "```\n"
            "â†‘ ã€Œâ—‹â—‹%: xxå›ã€ã¯, xxå›å¼•ã‘ã°â—‹â—‹%ã®ç¢ºç‡ã§ã‚¢ã‚¤ãƒ†ãƒ ãŒæƒã†ã¨ã„ã†æ„å‘³ã§ã™\n\n"
            "### âœ¨ å¿œç”¨\n"
            "ã‚¢ã‚¤ãƒ†ãƒ ã¯è¤‡æ•°æŒ‡å®šã§ãã‚‹ãï¼"
            "```\n"
            "!gacha\n"
            "ã‚¢ã‚¤ãƒ†ãƒ A, 0.1\n"
            "ã‚¢ã‚¤ãƒ†ãƒ B, 1/100  (â˜œåˆ†æ•°è¡¨è¨˜ã‚‚å¯ï¼)\n"
            "ã‚¢ã‚¤ãƒ†ãƒ C, 1/1000, 2  (â˜œå¿…è¦æ•°ã‚’2å€‹ã«æŒ‡å®š)\n"
            "```\n"
            "ç¢ºç‡ã‚’æ•´æ•°æ¯”ã¨ã—ã¦æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚å¯ï¼ˆå‡ºç¾ç¢ºç‡ã‚’å…¨ã¦æ•´æ•°ã§æŒ‡å®šï¼‰"
            "```\n"
            "!gacha\n"
            "å¤§å½“ãŸã‚Š, 1  (â˜œ1/6ã®ç¢ºç‡)\n"
            "ã‚ãŸã‚Š, 2  (â˜œ2/6ã®ç¢ºç‡)\n"
            "ãƒã‚ºãƒ¬, 3, 0  (â˜œ3/6ã®ç¢ºç‡, å¿…è¦æ•°0ãªã®ã§å–ã£ã¦ã‚‚ç„¡é§„)\n"
            "```\n"
            "### âš ï¸ æ³¨æ„\n"
            "ã‚µãƒ¼ãƒã§ã‚´ãƒªã‚´ãƒªã®è¡Œåˆ—è¨ˆç®—ã‚’ã—ã¦ã„ã‚‹éƒ½åˆä¸Šã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¢ã‚¤ãƒ†ãƒ ãƒªã‚¹ãƒˆã‚’æŒ‡å®šã™ã‚‹ã¨ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã™...\n"
            "- ã‚ã¾ã‚Šã«ã‚‚å‡ºç¾ç¢ºç‡ãŒä½ã™ãã‚‹ã‚¢ã‚¤ãƒ†ãƒ \n"
            "- ç•°ãªã‚‹ã‚¢ã‚¤ãƒ†ãƒ /å‡ºç¾ç¢ºç‡/å¿…è¦æ•°ã®çµ„ã¿åˆã‚ã›ãŒå¤šã™ãã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³"
        )
        await message.channel.send(response)


client.run(TOKEN)
